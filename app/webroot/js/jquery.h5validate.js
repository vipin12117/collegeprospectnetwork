(function($){'use strict';var console=window.console||function(){},h5={defaults:{debug:false,RODom:false,patternLibrary:{phone:/([\+][0-9]{1,3}([ \.\-])?)?([\(]{1}[0-9]{3}[\)])?([0-9A-Z \.\-]{1,32})((x|ext|extension)?[0-9]{1,4}?)/,email:/((([a-zA-Z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-zA-Z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?/,url:/(https?|ftp):\/\/(((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-zA-Z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-zA-Z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?/,number:/-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?/,dateISO:/\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/,alpha:/[a-zA-Z]+/,alphaNumeric:/\w+/,integer:/-?\d+/},classPrefix:'h5-',errorClass:'ui-state-error',validClass:'ui-state-valid',activeClass:'active',requiredClass:'required',requiredAttribute:'required',patternAttribute:'pattern',errorAttribute:'data-h5-errorid',customEvents:{'validate':true},kbSelectors:':input:not(:button):not(:disabled):not(.novalidate)',focusout:true,focusin:false,change:true,keyup:false,activeKeyup:true,mSelectors:'[type="range"]:not(:disabled):not(.novalidate), :radio:not(:disabled):not(.novalidate), :checkbox:not(:disabled):not(.novalidate), select:not(:disabled):not(.novalidate), option:not(:disabled):not(.novalidate)',click:true,requiredVar:'h5-required',patternVar:'h5-pattern',stripMarkup:true,submit:true,invalidCallback:function(){},validCallback:function(){},validateOnSubmit:true,allValidSelectors:':input:visible:not(:button):not(:disabled):not(.novalidate)',markInvalid:function markInvalid(options){var $element=$(options.element),$errorID=$(options.errorID);$element.addClass(options.errorClass).removeClass(options.validClass);$element.addClass(options.settings.activeClass);if($errorID.length){if($element.attr('title')){$errorID.text($element.attr('title'));}
$errorID.show();}
$element.data('valid',false);options.settings.invalidCallback.call(options.element,options.validity);return $element;},markValid:function markValid(options){var $element=$(options.element),$errorID=$(options.errorID);$element.addClass(options.validClass).removeClass(options.errorClass);if($errorID.length){$errorID.hide();}
$element.data('valid',true);options.settings.validCallback.call(options.element,options.validity);return $element;},unmark:function unmark(options){var $element=$(options.element);$element.removeClass(options.errorClass).removeClass(options.validClass);$element.form.find("#"+ options.element.id).removeClass(options.errorClass).removeClass(options.validClass);return $element;}}},defaults=h5.defaults,patternLibrary=defaults.patternLibrary,createValidity=function createValidity(validity){return $.extend({customError:validity.customError||false,patternMismatch:validity.patternMismatch||false,rangeOverflow:validity.rangeOverflow||false,rangeUnderflow:validity.rangeUnderflow||false,stepMismatch:validity.stepMismatch||false,tooLong:validity.tooLong||false,typeMismatch:validity.typeMismatch||false,valid:validity.valid||true,valueMissing:validity.valueMissing||false},validity);},methods={isValid:function(){var $this=$(this);$this.trigger('validate');return $this.data('valid');},allValid:function(settings){var valid=true,formValidity=[],$this=$(this);$this.find(settings.allValidSelectors).each(function(){var $this=$(this);$this.bind('validated',function(e,data){data.e=e;formValidity.push(data);});valid=$(this).h5Validate('isValid')&&valid;});$this.trigger('formValidated',{valid:valid,elements:formValidity});return valid;},validate:function(settings){var $this=$(this),pattern=$this.filter('[pattern]')[0]?$this.attr('pattern'):false,re=new RegExp('^(?:'+ pattern+')$'),value=($this.is('[type=checkbox]')||$this.is('[type=radio]'))?$this.is(':checked'):$this.val(),errorClass=settings.errorClass,validClass=settings.validClass,errorIDbare=$this.attr(settings.errorAttribute)||false,errorID=errorIDbare?'#'+ errorIDbare:false,required=false,validity=createValidity({element:this,valid:true}),$checkRequired=$('<input required>');if($checkRequired.filter('[required]')&&$checkRequired.filter('[required]').length){required=($this.filter('[required]').length&&$this.attr('required')!=='false');}else{required=($this.attr('required')!==undefined);}
if(settings.debug&&window.console){console.log('Validate called on "'+ value+'" with regex "'+ re+'". Required: '+ required);console.log('Regex test: '+ re.test(value)+', Pattern: '+ pattern);}
if(required&&!value){validity.valid=false;validity.valueMissing=true;}else if(pattern&&!re.test(value)&&value){validity.valid=false;validity.patternMismatch=true;}else{validity.valid=true;if(!settings.RODom){settings.markValid({element:this,validity:validity,errorClass:errorClass,validClass:validClass,errorID:errorID,settings:settings});}}
if(!validity.valid){if(!settings.RODom){settings.markInvalid({element:this,validity:validity,errorClass:errorClass,validClass:validClass,errorID:errorID,settings:settings});}}
$this.trigger('validated',validity);},delegateEvents:function(selectors,eventFlags,element,settings){var events=[],key=0,validate=function(){settings.validate.call(this,settings);};$.each(eventFlags,function(key,value){if(value){events[key]=key;}});for(key in events){if(events.hasOwnProperty(key)){$(element).delegate(selectors,events[key]+'.h5Validate',validate);}}
return element;},bindDelegation:function(settings){$.each(patternLibrary,function(key,value){var pattern=value.toString();pattern=pattern.substring(1,pattern.length- 1);$('.'+ settings.classPrefix+ key).attr('pattern',pattern);});$(this).filter('form').attr('novalidate','novalidate');$(this).find('form').attr('novalidate','novalidate');$(this).parents('form').attr('novalidate','novalidate');return this.each(function(){var kbEvents={focusout:settings.focusout,focusin:settings.focusin,change:settings.change,keyup:settings.keyup},mEvents={click:settings.click},activeEvents={keyup:settings.activeKeyup};settings.delegateEvents(':input',settings.customEvents,this,settings);settings.delegateEvents(settings.kbSelectors,kbEvents,this,settings);settings.delegateEvents(settings.mSelectors,mEvents,this,settings);settings.delegateEvents(settings.activeClassSelector,activeEvents,this,settings);});}},instances=[],buildSettings=function buildSettings(options){var settings=$.extend({},defaults,options,methods),activeClass=settings.classPrefix+ settings.activeClass;return $.extend(settings,{activeClass:activeClass,activeClassSelector:'.'+ activeClass,requiredClass:settings.classPrefix+ settings.requiredClass});},getInstance=function getInstance(){var $parent=$(this).closest('[data-h5-instanceId]');return instances[$parent.attr('data-h5-instanceId')];},setInstance=function setInstance(settings){var instanceId=instances.push(settings)- 1;if(settings.RODom!==true){$(this).attr('data-h5-instanceId',instanceId);}
$(this).trigger('instance',{'data-h5-instanceId':instanceId});};$.h5Validate={addPatterns:function(patterns){var patternLibrary=defaults.patternLibrary,key;for(key in patterns){if(patterns.hasOwnProperty(key)){patternLibrary[key]=patterns[key];}}
return patternLibrary;},validValues:function(selector,values){var i=0,ln=values.length,pattern='',re;for(i=0;i<ln;i+=1){pattern=pattern?pattern+'|'+ values[i]:values[i];}
re=new RegExp('^(?:'+ pattern+')$');$(selector).data('regex',re);}};$.fn.h5Validate=function h5Validate(options){var action,args,settings;if(typeof options==='string'&&typeof methods[options]==='function'){settings=getInstance.call(this);args=[].slice.call(arguments,0);action=options;args.shift();args=$.merge(args,[settings]);return settings[action].apply(this,args);}
settings=buildSettings(options);setInstance.call(this,settings);return methods.bindDelegation.call(this,settings);};}(jQuery));