<?php    include_once ("inc/common_functions.php");    //for common function    include_once ("inc/page.inc.php");    session_start();    if (($_SESSION['mode'] == "") or ($_SESSION['FRONTEND_USER'] == "")) {        header("Location:index.php");    }    //for paging    $func = new COMMONFUNC;    $db = new DB;    $flag = 0;    $error_msg = '';    $fldUsername = $_SESSION['FRONTEND_USER'];    $query = " Select * from " . TBL_HS_AAU_COACH . " where fldUsername = '$fldUsername' ";    $db -> query($query);    $db -> next_record();    $fldName = $func -> output_fun($db -> f('fldName'));    $fldEmail = $func -> output_fun($db -> f('fldEmail'));    $fldAEmail = $func -> output_fun($db -> f('fldAEmail'));    $fldLastName = $func -> output_fun($db -> f('fldLastName'));    $fldPhone = $func -> output_fun($db -> f('fldPhone'));    $fldAPhone = $func -> output_fun($db -> f('fldAPhone'));    $fldSchool = $func -> output_fun($db -> f('fldSchool'));    $fldPosition = $func -> output_fun($db -> f('fldPosition'));    $fldPassword = $func -> output_fun($db -> f('fldPassword'));    $fldStatus = $func -> output_fun($db -> f('fldStatus'));    $fldSport = $func -> output_fun($db -> f('fldSport'));    $fldCoachMemberId = $func -> output_fun($db -> f('fldId'));        //Get SportsCount    $WHERESportsCount ="fldCoachNameId ='".$fldCoachMemberId."'";    $ResultSportslist=$func->selectTableCon(TBL_HS_AAU_COACH_SPORT_POSITION,"fldId,fldCoachNameId,fldPosition,fldSportId",$WHERESportsCount);    $intSportsCount=count($ResultSportslist);            if ($_POST['isSubmit'] == 'save') {        $error_msgg = array();        if ($_REQUEST['fldName'] == '') {            $error_msgg[] = "Please Enter Name";        }        if ($_REQUEST['fldEmail'] == '') {            $error_msgg[] = "Please Enter Email";        }        if ($_REQUEST['fldPhone'] == '') {            $error_msgg[] = "Please Enter Phone";        }        if ($_REQUEST['fldSchool'] == '') {            $error_msgg[] = "Please Select High School / AAU Team";        }        if ($_REQUEST['fldSport'] == '') {            $error_msgg[] = "Please Select Sport";        }        if ($_REQUEST['fldPosition'] == '') {            $error_msgg[] = "Please Enter Position";        }        $where = "fldUsername='" . $fldUsername . "'";        $strDataArr = array('fldName' => $func -> input_fun($_POST['fldName']), 'fldLastName' => $func -> input_fun($_POST['fldLastName']), 'fldEmail' => $func -> input_fun($_POST['fldEmail']), 'fldAEmail' => $func -> input_fun($_POST['fldAEmail']), 'fldPhone' => $func -> input_fun($_POST['fldPhone']), 'fldAPhone' => $func -> input_fun($_POST['fldAPhone']), 'fldSchool' => $func -> input_fun($_POST['fldSchool']), 'fldSport' => $func -> input_fun($_POST['fldSport']), 'fldPosition' => $func -> input_fun($_POST['fldPosition']));        if (count($error_msgg) == 0) {            $db -> updateRec(TBL_HS_AAU_COACH, $strDataArr, $where);            $delete_query_details = "delete from " . TBL_HS_AAU_COACH_SPORT_POSITION . " where fldCoachNameId='" . $fldCoachMemberId . "'";            $delmsg = $db -> query($delete_query_details);            for ($n = 0; $n < $_POST['currentrow']; $n++) {                if ($n == 0) {                    $strDataArrw = array('fldSportId' => $func -> input_fun($_POST['fldSport']), 'fldPosition' => $func -> input_fun($_POST['fldPosition']), 'fldCoachNameId' => $fldCoachMemberId);                    $db -> insertRec(TBL_HS_AAU_COACH_SPORT_POSITION, $strDataArrw);                } else {                    $strDataArrw = array('fldSportId' => $func -> input_fun($_POST['fldSport' . $n]), 'fldPosition' => $func -> input_fun($_POST['fldPosition' . $n]), 'fldCoachNameId' => $fldCoachMemberId);                    $db -> insertRec(TBL_HS_AAU_COACH_SPORT_POSITION, $strDataArrw);                }            }            #redirect to listing page on successfull updation            //$returnmsg = "You have successfully updated profile." . "SportCount-" . $_POST['currentrow'];                        $returnmsg = "You have successfully updated profile.";                   header("Location: myaccount.php?page=" . $_REQUEST['page'] . "&msg=" . $returnmsg);        }    }?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">	<head>		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />		<title>College Prospect Network</title>		<link href="css/style.css" rel="stylesheet" type="text/css" />		<script language="Javascript" src="javascript/functions.js"></script>		<script language="JavaScript" type="text/JavaScript">				var currentrow = "<?php echo $intSportsCount; ?>";		//alert(currentrow);		            function validate() {                var error_msg = "";                if(trimString(document.frmCoachReg.fldName.value) == "") {                    error_msg += "Please Enter Name. \n";                } else {                    if(hasSpecialCharaters(document.frmCoachReg.fldName.value)) {                        error_msg += "Enter valid  Name. \n";                    }                }                if(trimString(document.frmCoachReg.fldLastName.value) == "") {                    error_msg += "Please Enter Last Name. \n";                } else {                    if(hasSpecialCharaters(document.frmCoachReg.fldLastName.value)) {                        error_msg += "Enter valid  Last Name. \n";                    }                }                if(trimString(document.frmCoachReg.fldEmail.value) == "") {                    error_msg += "Please Enter Email. \n";                } else {                    if(!isValid(document.frmCoachReg.fldEmail.value)) {                        error_msg += "Enter Valid Email. \n";                    }                }                if(trimString(document.frmCoachReg.fldPhone.value) == "") {                    error_msg += "Please Enter Your Phone. \n";                } else {                    if(hasSpecialCharaters(document.frmCoachReg.fldPhone.value)) {                        error_msg += "Enter valid  Phone. \n";                    }                }                if(trimString(document.frmCoachReg.fldSchool.value) == 0) {                    error_msg += "Please Select School. \n";                }                // if(trimString(document.frmCoachReg.fldSport.value) == 0) {
                    // error_msg += "Please Select Sport. \n";
                // }
                // if(trimString(document.frmCoachReg.fldPosition.value) == '') {
                    // error_msg += "Please Enter Position! \n";
                // }                                 //Loop through dynamic Sport rows                var intSportRows = document.getElementById('currentrow').value;                                 for (i = 0; i < intSportRows; i++) {                    valsport = trimString(document.getElementById('fldSport' + i).value);                    valpos = trimString(document.getElementById('fldPosition' + i).value);                                        //alert('currentrow:' + i + ' sport:' + valsport + '|position:' + valpos);                                        friendlyRowID = i + 1;                    if (i==0) {                        friendlyRowID = "";                    }                    if(valsport == '') {                    error_msg += "Please Select Sport " + friendlyRowID + "! \n";                                        }                    if(valpos == '') {                        error_msg += "Please Enter Position " + friendlyRowID + "! \n";                       }                                              }                //end loop                 if(error_msg != '') {                    alert(error_msg);                    return false;                } else {                    return true;                }            }            function addfields() {                currentrow = parseInt(document.frmCoachReg.currentrow.value);                //alert(currentrow);                document.getElementById('trs_' + currentrow).style.display = "";                document.getElementById('trc_' + currentrow).style.display = "";                //document.getElementById('trsb_'+currentrow).style.display= "";                //document.getElementById('trcb_'+currentrow).style.display= "";                document.getElementById('currentrow').value = currentrow + 1;                if(document.getElementById('currentrow').value >= 1) {                    document.getElementById('remfield').style.display = "";                }            }            function removefields() {                currentrow = parseInt(document.frmCoachReg.currentrow.value);                                currentrow--;                //alert(currentrow);                document.getElementById('trs_' + currentrow).style.display = "none";                document.getElementById('trc_' + currentrow).style.display = "none";                if(currentrow == 1) {                    document.getElementById('remfield').style.display = "none";                    document.getElementById('currentrow').value = currentrow;                } else {                    currentrow++;                    document.getElementById('currentrow').value = currentrow - 1;                }            }		</script>	</head>	<body>		<!--header link starts from here -->		<?php            include ('header.php');		?>		<!--Header ends from here -->		<!--middle panel starts from here -->		<!--content panel starts from here -->		<div class="container">			<div class="innerWraper">				<div class="middle-bg">					<div class="cantener">						<div class="register-main">							<h1>Edit Profile</h1>							<?phpif (count($error_msgg)>0){foreach($error_msgg as $key=>$value){							?>							<div class="thankyoumessage">								<?php  echo $value . "<br>";?>							</div>							<?                                }                                }							?>							<span style="float:right;"> <font color="#0000ff">&nbsp;*</font> Fields are Mandatory.</span>							<div class="registerPage">								<form name="frmCoachReg" action="" method="post" enctype="multipart/form-data" onsubmit="return validate()">									<p>										<label>First Name:</label>										<span>											<input type="text" name="fldName" value="<?=$fldName?>" />										</span><font color="#0000ff">&nbsp;*</font>									</p>									<p>										<label>Last Name:</label>										<span>											<input type="text" name="fldLastName" value="<?=$fldLastName?>" />										</span><font color="#0000ff">&nbsp;*</font>									</p>									<p>										<label>Email:</label>										<span>											<input type="text" name="fldEmail" value="<?=$fldEmail?>" />										</span><font color="#0000ff">&nbsp;*</font>									</p>									<p>										<label>Alternate Email:</label>										<span>											<input type="text" name="fldAEmail" value="<?=$fldAEmail?>" />											</span									</p>									<p>										<label>Phone:</label>										<span>											<input type="text" name="fldPhone"  value="<?=$fldPhone?>" />										</span><font color="#0000ff">&nbsp;*</font>									</p>									<p>										<label>Alternate Phone:</label>										<span>											<input type="text" name="fldAPhone"  value="<?=$fldAPhone?>" />										</span>									</p>									<p>										<label>High School/AAU Team:</label>										<span> <?php                                            echo $strcombo = '<select name="fldSchool" style="width:276px" readonly>';                                            echo $strcombo = '<option value = 0>Select School</option>';                                            $categorylist = $func -> selectTableOrder(TBL_HS_AAU_TEAM, "fldId,fldSchoolname", "fldSchoolname");                                            for ($i = 0; $i < count($categorylist); $i++) {                                                if ($categorylist[$i]['fldId'] == $fldSchool) {                                                    echo '<option value ="' . $categorylist[$i]['fldId'] . '" selected="selected" >' . $categorylist[$i]['fldSchoolname'] . '</option>';                                                } else {                                                    echo '<option value ="' . $categorylist[$i]['fldId'] . '">' . $categorylist[$i]['fldSchoolname'] . '</option>';                                                }                                            }                                            echo $strcombo = '</select>';                                        ?></span><font color="#0000ff">&nbsp;*</font>                                        </p>                                                                                                                        <?php                                        $whrecon1 ="fldCoachNameId ='".$fldCoachMemberId."'";                                        $sportslist=$func->selectTableCon(TBL_HS_AAU_COACH_SPORT_POSITION,"fldId,fldCoachNameId,fldPosition,fldSportId",$whrecon1);                                        $sportscount=count($sportslist);                                        for ($k=0;$k<$sportscount;$k++)                                        {                                        ?>                                        <?php                                        if ($k==0)                                        {											?>											<p id="trs_<?php  echo $k;?>">												<label>Sport:</label>												<?php  } else {?><p id="trs_<?php  echo $k;?>"><label>Sport <?php  echo ($k+1);?>:</label> <?php                                                    }												?>												<span><?php                                                    if ($k == 0) {                                                        echo $strcombo = '<select name="fldSport" id="fldSport0">';                                                    } else {                                                        echo $strcombo = '<select name="fldSport' . $k . '" ID="fldSport' . $k . '">';                                                    }                                                    echo $strcombo = '<option value = "">Select Sport</option>';                                                    $categorylist = $func -> selectTableOrder(tbl_sports, "fldId,fldSportsname", "fldSportsname");                                                    for ($i = 0; $i < count($categorylist); $i++) {                                                        if ($sportslist[$k]['fldSportId'] == $categorylist[$i]['fldId']) {                                                            echo '<option value ="' . $categorylist[$i]['fldId'] . '" selected="selected" >' . $categorylist[$i]['fldSportsname'] . '</option>';                                                        } else {                                                            echo '<option value ="' . $categorylist[$i]['fldId'] . '" >' . $categorylist[$i]['fldSportsname'] . '</option>';                                                        }                                                    }                                                    echo $strcombo = '</select>';												?></span><font color="#0000ff">&nbsp;*</font>												</p>												<?php												if ($k==0)												{												?>												<p id="trc_<?php  echo $k;?>">												<label>Position:</label>												<?php  }                                                    else                                                    {												?><p id="trc_<?php  echo $k;?>"><label>Position <?php  echo ($k+1);?>:</label><?php                                                    }												?>												<span><?php                                                    if ($k == 0) {                                                        echo $strcombo = '<input type = "text" name="fldPosition" ID="fldPosition0"  value="' . $sportslist[$k]['fldPosition'] . '">';                                                    } else {                                                        echo $strcombo = '<input type = "text" name="fldPosition' . $k . '" ID="fldPosition' . $k . '"  value="' . $sportslist[$k]['fldPosition'] . '">';                                                    }												?>												</span><font color="#0000ff">&nbsp;*</font>												</p>												<?php }?> <?php												for ($k=$sportscount;$k<=25;$k++)												{ ?>												<p style="display:none" id="trs_<?php  echo $k;?>">												<label>Sport <?php  echo $k;?>:</label>												<span>												<?php                                                    echo $strcombo = '<select name="fldSport' . $k . '" ID="fldSport' . $k . '">';                                                    echo $strcombo = '<option value = "">Select Sport</option>';                                                    $categorylist = $func -> selectTableOrder(tbl_sports, "fldId,fldSportsname", "fldSportsname");                                                    for ($i = 0; $i < count($categorylist); $i++) {                                                        echo '<option value ="' . $categorylist[$i]['fldId'] . '" >' . $categorylist[$i]['fldSportsname'] . '</option>';                                                    }                                                    echo $strcombo = '</select>';												?>												</span>												</p>												<p style="display:none" id="trc_<?php  echo $k;?>">												<label>Position <?php  echo $k;?>:</label>												<span>												<?php                                                    echo $strcombo = '<input type = "text" name="fldPosition' . $k . '" ID="fldPosition' . $k . '">';												?>												</span>												</p>												<?php                                                    }												?>																																				<p style="margin-bottom:3px;padding-bottom:0;" class="lineheightnormal">                                                    <label>&nbsp;</label>                                                    <span style="font-weight:bold;">Do you coach more than one sport?</span>                                                </p>												<p class="lineheightnormal">    												<label>&nbsp;</label>    												<span><input type="hidden" name="currentrow" value="<?php  echo $sportscount;?>" id="currentrow">    												<input type="hidden" name="totalcount" value="25" id="totalcount">    												<a href="#" onclick="javascript:addfields(); return false;" style="float:left;text-decoration: none">[+] Add Sport</a>    												<span id="remfield">&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" onclick="javascript:removefields(); return false;" style="text-decoration: none">[-] Remove Sport</a></span>    												</span>												</p>																																				<p style="padding-top:10px;">    												<label>&nbsp;</label>    												<span><input type="hidden" name="isSubmit" value="save">    												<input type="submit" value="Update"/>    												<INPUT TYPE="BUTTON" VALUE="Back" ONCLICK="history.go(-1)"></span>												</p>								</form>							</div>						</div>					</div>				</div>			</div>		</div>		<?php            include ('footer.php');		?>	</body></html>